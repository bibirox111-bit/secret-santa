<header class="top-nav">
  <div class="left">
    <span class="logo" (click)="navigateHome()">üéÅ Secret Santa</span>
  </div>

  <nav class="nav-links">
    <a class="nav-link" (click)="navigateHome()">
      <mat-icon>home</mat-icon>
      <span class="link-text">Home</span>
    </a>
    <a class="nav-link" (click)="navigateToEvents()">
      <mat-icon>celebration</mat-icon>
      <span class="link-text">Events</span>
    </a>
    <a class="nav-link" (click)="navigateToInvitations()" [matBadge]="(invitesCount$ | async) || 0" matBadgeColor="accent" [matBadgeHidden]="((invitesCount$ | async) || 0) === 0">
      <mat-icon>mail</mat-icon>
      <span class="link-text">Invitations</span>
    </a>
  </nav>

  <div class="right">
    @if (authService.user$ | async; as user) {
      <div class="user-section">
        <img class="avatar"
          src="https://api.dicebear.com/9.x/initials/svg?seed={{user.displayName}}"
          alt="avatar"
          [matMenuTriggerFor]="invitesMenu"
          [matBadge]="(invitesCount$ | async) || 0"
          matBadgeColor="accent"
          [matBadgeHidden]="((invitesCount$ | async) || 0) === 0"
          class="avatar-badge" />
        <mat-menu #invitesMenu="matMenu">
          @let count = (invitesCount$ | async) || 0;
          @if (count > 0) {
            <div style="padding: 8px 16px; min-width: 250px">
              <p style="margin: 0; font-weight: 500; color: #666; font-size: 12px">PENDING INVITATIONS</p>
              @for (invite of pendingInvites$ | async; track invite.id) {
                <div style="padding: 8px; margin: 8px 0; background: #f5f5f5; border-radius: 4px; font-size: 13px">
                  <strong>{{ invite.eventId }}</strong><br>
                  From: {{ invite.inviterUserId }}
                </div>
              }
              <hr style="margin: 8px 0">
              <button mat-menu-item (click)="navigateToInvitations()" style="width: 100%; justify-content: center">
                <mat-icon>arrow_forward</mat-icon>
                <span>View All</span>
              </button>
            </div>
          } @else {
            <button mat-menu-item disabled>
              <span>No pending invitations</span>
            </button>
          }
        </mat-menu>
        <mat-icon [matMenuTriggerFor]="userMenu">account_circle</mat-icon>
        <mat-icon (click)="logout()">logout</mat-icon>
        <mat-menu #userMenu="matMenu">
          <button mat-menu-item (click)="theme.toggle()">
            <mat-icon>{{ theme.current === 'dark' ? 'light_mode' : 'dark_mode' }}</mat-icon>
            <span>Switch to {{ theme.current === 'dark' ? 'Light' : 'Dark' }} Mode</span>
          </button>
        </mat-menu>
      </div>
    }
  </div>
</header>